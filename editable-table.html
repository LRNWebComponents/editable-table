<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-tooltip/paper-tooltip.html">
<link rel="import" href="../paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="editable-table-behaviors.html">
<link rel="import" href="editable-table-editor.html">
<link rel="import" href="editable-table-display.html">
<!--
`editable-table`
A LRN element
@demo demo/index.html

@microcopy - the mental model for this element
 -
 -
 -
hideBordered
-->

<dom-module id="editable-table">
  <template>
    <paper-tooltip for="button" position="left">Edit this table.</paper-tooltip>
    <template id="display" is="dom-if" if="[[!editMode]]" restamp="true">
      <editable-table-display
        accent-color$="[[accentColor]]" 
        caption$="[[caption]]" 
        column-header$="[[columnHeader]]" 
        dark$="[[dark]]" 
        data$="[[data]]"
        bordered$="[[bordered]]" 
        condensed$="[[condensed]]" 
        filter$="[[filter]]" 
        row-header$="[[rowHeader]]"
        sort$="[[sort]]" 
        scroll$="[[scroll]]" 
        striped$="[[striped]]" 
        summary$="[[summary]]">
      </editable-table-display>
    </template>
    <template id="editor" is="dom-if" if="[[editMode]]" restamp="true">
      <editable-table-editor
        accent-color$="{{accentColor}}" 
        caption$="{{caption}}" 
        column-header$="{{columnHeader}}" 
        dark$="{{dark}}" 
        data$="{{data}}" 
        enabled$="{{editMode}}" 
        hide-accent-color$="{{hideAccentColor}}" 
        hide-dark-theme$="{{hideDarkTheme}}" 
        hide-bordered$="{{hideBordered}}" 
        hide-condensed$="{{hideCondensed}}" 
        hide-filter$="{{hideFilter}}" 
        hide-sort$="{{hideSort}}" 
        hide-scroll$="{{hideScroll}}" 
        hide-striped$="{{hideStriped}}"
        bordered$="{{bordered}}" 
        condensed$="{{condensed}}" 
        filter$="{{filter}}" 
        row-header$="{{rowHeader}}"
        sort$="{{sort}}" 
        scroll$="{{scroll}}" 
        striped$="{{striped}}" 
        summary$="{{summary}}">
      </editable-table-editor>
    </template>
  </template>

  <script>
    Polymer({
      is: 'editable-table',
      
      behaviors: [
        editableTableBehaviors.displayBehaviors,
        editableTableBehaviors.editBehaviors  
      ],

      properties: {
        editMode: {
          type: Boolean,
          value: false
        }
      },
      toggleEditMode: function(edit){
        edit = edit !== undefined ? edit : !this.editMode;
        if(edit){
          this.editMode = true;
        } else {
          let temp = this.querySelector('editable-table-editor').getData();
          for(prop in temp){
            if(prop !== 'data') {
              this[prop] = temp[prop];
            } else {
              this.set('data',temp[prop]);
            }
          }
          this.editMode = false;
        }
      }
    });
  </script>
</dom-module>
